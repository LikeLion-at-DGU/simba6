{% extends 'base.html' %}
{% load static %}

{% block content %}
<form method="POST" action="{% url 'accounts:signup' %}">
    {% csrf_token %}
    <p>username</p>
    <input type="text" name="username" id="username-input">
    <br> <!--한줄 띄기-->

    <button type="button" id="email-confirm-btn" disabled>인증메일</button>
    <br>

    {% if email_sent %}
        <h3>이메일이 성공적으로 보내졌습니다!</h3>
    {% else %}
        <h3>이메일 보내기 실패</h3>
    {% endif %}

    <p>비밀번호</p>
    <input type="password" name="password">
    <br>

    <p>비밀번호확인</p>
    <input type="password" name="confirm">
    <br>

    <p>학년</p>
    <input type="number" name="grade" min="1" max="4">
    <br>

    <p>학과</p>
    <input type="text" name="department">
    <br>

    <p>이름</p>
    <input type="text" name="name">
    <br>

    <p>별명</p>
    <input type="text" name="nickname">
    <br>

    <input type="submit" value="회원가입">
</form>

<script>
    var usernameInput = document.getElementById('username-input');
    var emailConfirmBtn = document.getElementById('email-confirm-btn');

    emailConfirmBtn.disabled = true;

    usernameInput.addEventListener('input', function() {
        if (usernameInput.value) {
            emailConfirmBtn.disabled = false;
        } else {
            emailConfirmBtn.disabled = true;
        }
    });

    emailConfirmBtn.addEventListener('click', function() {
        var username = usernameInput.value;
        if (username) {
            console.log(username);
            var emailConfirmUrl = "{% url 'accounts:emailconfirm' username='__USERNAME__' %}".replace('__USERNAME__', username);
            window.location.href = emailConfirmUrl;
        }
    });
</script>

{% endblock %}
